<!DOCTY "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xht />
<title>ZZPRM_006</title>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: ZZPRM_006</h2>
<h3> Description: </h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="codeComment">
***&---------------------------------------------------------------------*<br />
***&&nbsp;Report&nbsp;ZZPRM_006<br />
***&---------------------------------------------------------------------*<br />
***&<br />
***&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
report zzprm_006.<br />
type-pools slis .<br />
data: gs_001  type zzprm_t001,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_log&nbsp;&nbsp;type&nbsp;zzprm_t003,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_log4&nbsp;type&nbsp;zzprm_t004.<br />
data: persno     type zzprm_pnum_de,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permformno&nbsp;type&nbsp;zzprm_izinformno_de,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sirano&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zzprm_t004-row_no,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;persad&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zzprm_t001-pnsurname,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yilizin&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zzprm_permtype_de,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mazizin&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zzprm_permtype_de,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bastarih&nbsp;&nbsp;&nbsp;type&nbsp;zzprm_bastarih_de,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bittarih&nbsp;&nbsp;&nbsp;type&nbsp;zzprm_bittarih_de,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;daysoff&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zzprm_izinligun_de,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aciklama&nbsp;&nbsp;&nbsp;type&nbsp;zzprm_aciklama_de,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kota&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zzprm_t002-quota.<br />
data: gs_layout type slis_layout_alv.<br />
data: gs_layout2 type slis_layout_alv.<br />
types: begin of t_t003,<br />
selkz          type char1,<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permformno&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zzprm_izinformno_de,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pno&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zzprm_pnum_de,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pnsurname&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zzprm_pnsurn_de,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pnsurname2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zzprm_pnsurn_de,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pnsurname3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zzprm_pnsurn_de,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;status&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zzprm_statu_de,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;status_text&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;ddtext,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;perm_type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zzprm_permtype_de,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;perm_type_text&nbsp;type&nbsp;ddtext,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;start_date&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zzprm_bastarih_de,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end_date&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zzprm_bittarih_de,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;days_off&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zzprm_izinligun_de,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;statement&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zzprm_aciklama_de,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pypno&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zzprm_t001-pypno,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;of&nbsp;t_t003.<br />
<br />
types: begin of gty_004,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permformno&nbsp;&nbsp;&nbsp;type&nbsp;zzprm_izinformno_de,<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_no&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zzprm_rowno_de,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;status&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zzprm_statu_de,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;status_text1&nbsp;type&nbsp;ddtext,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pnsurname&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zzprm_pnsurn_de,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;date_&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zzprm_date_de,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hour_&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zzprm_hour_de,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;statement&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zzprm_aciklama_de,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;of&nbsp;gty_004.<br />
<br />
<br />
<br />
<br />
<br />
data: gt_t004 type table of gty_004,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t004&nbsp;type&nbsp;gty_004,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;go_salv&nbsp;type&nbsp;ref&nbsp;to&nbsp;cl_salv_table.<br />
<br />
data: gt_list type table of t_t003,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_list&nbsp;type&nbsp;t_t003.<br />
<br />
data : it_fcat type slis_t_fieldcat_alv .<br />
data : wa_fcat like line of it_fcat .<br />
<br />
<br />
   </div>
   <div class="codeComment">
*select-options:&nbsp;s_pno&nbsp;for&nbsp;gs_001-pno.<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
   </div>
   <div class="code">
start-of-selection .<br />
&nbsp;&nbsp;perform&nbsp;get_data&nbsp;.<br />
&nbsp;&nbsp;perform&nbsp;create_fcat.<br />
&nbsp;&nbsp;perform&nbsp;set_layout.<br />
<br />
<br />
end-of-selection .<br />
&nbsp;&nbsp;perform&nbsp;disp_alv&nbsp;.<br />
<br />
<br />
<br />
<br />
<br />
<br />
form get_data .<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;select<br />
*&nbsp;&nbsp;&nbsp;&nbsp;permformno<br />
*&nbsp;&nbsp;&nbsp;&nbsp;pno<br />
*&nbsp;&nbsp;&nbsp;&nbsp;status<br />
*&nbsp;&nbsp;&nbsp;&nbsp;perm_type<br />
*&nbsp;&nbsp;&nbsp;&nbsp;start_date<br />
*&nbsp;&nbsp;&nbsp;&nbsp;end_date<br />
*&nbsp;&nbsp;&nbsp;&nbsp;days_off<br />
*&nbsp;&nbsp;&nbsp;&nbsp;statement<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zzprm_t003<br />
*&nbsp;&nbsp;&nbsp;&nbsp;into&nbsp;corresponding&nbsp;fields&nbsp;of&nbsp;table&nbsp;gt_list&nbsp;where&nbsp;pypno&nbsp;in&nbsp;s_pno.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;data&nbsp;lt_t001&nbsp;type&nbsp;standard&nbsp;table&nbsp;of&nbsp;zzprm_t001.<br />
&nbsp;&nbsp;data&nbsp;ls_t001&nbsp;like&nbsp;line&nbsp;of&nbsp;lt_t001.<br />
<br />
&nbsp;&nbsp;select&nbsp;*&nbsp;from&nbsp;zzprm_t001&nbsp;into&nbsp;table&nbsp;lt_t001.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;pypno&nbsp;in&nbsp;s_pno.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;select&nbsp;*&nbsp;from&nbsp;zzprm_t003<br />
&nbsp;&nbsp;&nbsp;&nbsp;into&nbsp;corresponding&nbsp;fields&nbsp;of&nbsp;table&nbsp;gt_list<br />
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;all&nbsp;entries&nbsp;in&nbsp;lt_t001<br />
&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;pno&nbsp;eq&nbsp;lt_t001-pno<br />
&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;status&nbsp;=&nbsp;'05'&nbsp;or&nbsp;status&nbsp;=&nbsp;'07'&nbsp;or&nbsp;status&nbsp;=&nbsp;'06'.<br />
<br />
<br />
<br />
   </div>
   <div class="codeComment">
*data:&nbsp;lv_pno&nbsp;type&nbsp;zzprm_t001-pno.<br />
<br />
*&nbsp;select&nbsp;single&nbsp;pno&nbsp;from&nbsp;zzprm_t001&nbsp;into&nbsp;lv_pno&nbsp;where&nbsp;pypno&nbsp;eq&nbsp;gs_001-pypno.<br />
<br />
*select&nbsp;*&nbsp;from&nbsp;zzprm_t001&nbsp;into&nbsp;corresponding&nbsp;fields&nbsp;of&nbsp;table&nbsp;gt_list<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;pypno&nbsp;IN&nbsp;s_pno.<br />
<br />
*&nbsp;SELECT&nbsp;permformno&nbsp;pno&nbsp;status&nbsp;perm_type&nbsp;start_date&nbsp;end_date<br />
*&nbsp;&nbsp;days_off&nbsp;statement&nbsp;FROM&nbsp;zzprm_t003<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;into&nbsp;corresponding&nbsp;fields&nbsp;of&nbsp;table&nbsp;gt_list<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;pno&nbsp;IN&nbsp;s_pno.<br />
*&nbsp;&nbsp;.<br />
<br />
<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;data&nbsp;lt_dd07t&nbsp;type&nbsp;standard&nbsp;table&nbsp;of&nbsp;dd07t.<br />
&nbsp;&nbsp;data&nbsp;ls_dd07t&nbsp;like&nbsp;line&nbsp;of&nbsp;lt_dd07t.<br />
<br />
&nbsp;&nbsp;select&nbsp;*&nbsp;from&nbsp;dd07t&nbsp;into&nbsp;table&nbsp;lt_dd07t<br />
&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;ddlanguage&nbsp;eq&nbsp;'T'<br />
&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;&nbsp;&nbsp;domname&nbsp;like&nbsp;'ZZPRM%'.<br />
<br />
&nbsp;&nbsp;loop&nbsp;at&nbsp;gt_list&nbsp;into&nbsp;gs_list.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;read&nbsp;table&nbsp;lt_dd07t&nbsp;into&nbsp;ls_dd07t&nbsp;with&nbsp;key&nbsp;domname&nbsp;=&nbsp;'ZZPRM_PERMTYPE_DO'&nbsp;domvalue_l&nbsp;=&nbsp;gs_list-perm_type.<br />
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;sy-subrc&nbsp;eq&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_list-perm_type_text&nbsp;=&nbsp;ls_dd07t-ddtext.<br />
&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;read&nbsp;table&nbsp;lt_dd07t&nbsp;into&nbsp;ls_dd07t&nbsp;with&nbsp;key&nbsp;domname&nbsp;=&nbsp;'ZZPRM_STATU_DO'&nbsp;domvalue_l&nbsp;=&nbsp;gs_list-status.<br />
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;sy-subrc&nbsp;eq&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_list-status_text&nbsp;=&nbsp;ls_dd07t-ddtext.<br />
&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;permformno&nbsp;from&nbsp;zzprm_t003&nbsp;into&nbsp;gs_list-permformno<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;pno&nbsp;eq&nbsp;gs_list-pno.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;pnsurname&nbsp;from&nbsp;zzprm_t001&nbsp;into&nbsp;gs_list-pnsurname<br />
&nbsp;&nbsp;where&nbsp;pno&nbsp;eq&nbsp;gs_list-pno.<br />
<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_list-pnsurname2&nbsp;=&nbsp;ls_t0011-pnsurname.<br />
<br />
*&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;permformno&nbsp;from&nbsp;zzprm_t003&nbsp;into&nbsp;gs_list-permformno<br />
*&nbsp;&nbsp;where&nbsp;pno&nbsp;eq&nbsp;gs_list-pno.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;modify&nbsp;gt_list&nbsp;from&nbsp;gs_list.<br />
<br />
&nbsp;&nbsp;endloop.<br />
<br />
<br />
endform.<br />
form set_layout .<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;gs_layout-window_titlebar&nbsp;=&nbsp;'Ýzin&nbsp;Raporu'.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;gs_layout-zebra&nbsp;=&nbsp;abap_true.<br />
&nbsp;&nbsp;gs_layout-colwidth_optimize&nbsp;=&nbsp;abap_true.<br />
&nbsp;&nbsp;gs_layout-colwidth_optimize&nbsp;=&nbsp;abap_true.<br />
&nbsp;&nbsp;gs_layout-box_fieldname&nbsp;=&nbsp;'SELKZ'.<br />
endform.<br />
<br />
<br />
form disp_alv .<br />
call function 'REUSE_ALV_GRID_DISPLAY'<br />
&nbsp;EXPORTING<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;I_INTERFACE_CHECK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'&nbsp;'<br />
*&nbsp;&nbsp;&nbsp;I_BYPASSING_BUFFER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'&nbsp;'<br />
*&nbsp;&nbsp;&nbsp;I_BUFFER_ACTIVE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'&nbsp;'<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;I_CALLBACK_PROGRAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sy-repid<br />
&nbsp;&nbsp;&nbsp;I_CALLBACK_PF_STATUS_SET&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'SUB_PF_STATUS'<br />
&nbsp;&nbsp;&nbsp;I_CALLBACK_USER_COMMAND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'USER_COMMAND'<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;I_CALLBACK_TOP_OF_PAGE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'&nbsp;'<br />
*&nbsp;&nbsp;&nbsp;I_CALLBACK_HTML_TOP_OF_PAGE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'&nbsp;'<br />
*&nbsp;&nbsp;&nbsp;I_CALLBACK_HTML_END_OF_LIST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'&nbsp;'<br />
*&nbsp;&nbsp;&nbsp;I_STRUCTURE_NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;I_BACKGROUND_ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'&nbsp;'<br />
*&nbsp;&nbsp;&nbsp;I_GRID_TITLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;I_GRID_SETTINGS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;IS_LAYOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_layout<br />
&nbsp;&nbsp;&nbsp;IT_FIELDCAT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;it_fcat<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;IT_EXCLUDING&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;IT_SPECIAL_GROUPS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;IT_SORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;IT_FILTER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;IS_SEL_HIDE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;I_DEFAULT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
*&nbsp;&nbsp;&nbsp;I_SAVE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'&nbsp;'<br />
*&nbsp;&nbsp;&nbsp;IS_VARIANT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;IT_EVENTS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;IT_EVENT_EXIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;IS_PRINT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;IS_REPREP_ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;I_SCREEN_START_COLUMN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0<br />
*&nbsp;&nbsp;&nbsp;I_SCREEN_START_LINE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0<br />
*&nbsp;&nbsp;&nbsp;I_SCREEN_END_COLUMN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0<br />
*&nbsp;&nbsp;&nbsp;I_SCREEN_END_LINE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0<br />
*&nbsp;&nbsp;&nbsp;I_HTML_HEIGHT_TOP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0<br />
*&nbsp;&nbsp;&nbsp;I_HTML_HEIGHT_END&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0<br />
*&nbsp;&nbsp;&nbsp;IT_ALV_GRAPHICS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;IT_HYPERLINK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;IT_ADD_FIELDCAT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;IT_EXCEPT_QINFO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;IR_SALV_FULLSCREEN_ADAPTER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;O_PREVIOUS_SRAL_HANDLER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;IMPORTING<br />
*&nbsp;&nbsp;&nbsp;E_EXIT_CAUSED_BY_CALLER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;ES_EXIT_CAUSED_BY_USER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
   </div>
   <div class="code">
&nbsp;&nbsp;tables<br />
&nbsp;&nbsp;&nbsp;&nbsp;t_outtab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gt_list<br />
   </div>
   <div class="codeComment">
*&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;PROGRAM_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
*&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
if sy-subrc &lt;&gt; 0.<br />
   </div>
   <div class="codeComment">
*&nbsp;Implement&nbsp;suitable&nbsp;error&nbsp;handling&nbsp;here<br />
   </div>
   <div class="code">
endif.<br />
<br />
<br />
endform.<br />
<br />
<br />
form create_fcat.<br />
<br />
&nbsp;&nbsp;wa_fcat-col_pos&nbsp;=&nbsp;'1'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-fieldname&nbsp;=&nbsp;'PERMFORMNO'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-tabname&nbsp;=&nbsp;'GT_LIST'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-seltext_m&nbsp;=&nbsp;'Ýzin&nbsp;Form&nbsp;No'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-key&nbsp;=&nbsp;'X'&nbsp;.<br />
&nbsp;&nbsp;append&nbsp;wa_fcat&nbsp;to&nbsp;it_fcat&nbsp;.<br />
&nbsp;&nbsp;clear&nbsp;wa_fcat&nbsp;.<br />
<br />
&nbsp;&nbsp;wa_fcat-col_pos&nbsp;=&nbsp;'12'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-fieldname&nbsp;=&nbsp;'PYPNO'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-tabname&nbsp;=&nbsp;'GT_LIST'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-seltext_m&nbsp;=&nbsp;'Yönetici&nbsp;No'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-key&nbsp;=&nbsp;'X'&nbsp;.<br />
&nbsp;&nbsp;append&nbsp;wa_fcat&nbsp;to&nbsp;it_fcat&nbsp;.<br />
&nbsp;&nbsp;clear&nbsp;wa_fcat&nbsp;.<br />
<br />
&nbsp;&nbsp;wa_fcat-col_pos&nbsp;=&nbsp;'2'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-fieldname&nbsp;=&nbsp;'PNO'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-tabname&nbsp;=&nbsp;'GT_LIST'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-seltext_m&nbsp;=&nbsp;'Pers&nbsp;No'&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;WA_FCAT-NO_OUT&nbsp;=&nbsp;'X'&nbsp;.<br />
*&nbsp;&nbsp;wa_fcat-hotspot&nbsp;=&nbsp;'X'&nbsp;.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;append&nbsp;wa_fcat&nbsp;to&nbsp;it_fcat&nbsp;.<br />
&nbsp;&nbsp;clear&nbsp;wa_fcat&nbsp;.<br />
<br />
&nbsp;&nbsp;wa_fcat-col_pos&nbsp;=&nbsp;'3'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-fieldname&nbsp;=&nbsp;'PNSURNAME'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-tabname&nbsp;=&nbsp;'GT_LIST'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-seltext_m&nbsp;=&nbsp;'Ad&nbsp;Soyad'&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;WA_FCAT-NO_OUT&nbsp;=&nbsp;'X'&nbsp;.<br />
*&nbsp;&nbsp;wa_fcat-hotspot&nbsp;=&nbsp;'X'&nbsp;.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;append&nbsp;wa_fcat&nbsp;to&nbsp;it_fcat&nbsp;.<br />
&nbsp;&nbsp;clear&nbsp;wa_fcat&nbsp;.<br />
<br />
&nbsp;&nbsp;wa_fcat-col_pos&nbsp;=&nbsp;'4'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-fieldname&nbsp;=&nbsp;'STATUS'&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;WA_FCAT-REF_FIELDNAME&nbsp;=&nbsp;'MBRSH'&nbsp;.<br />
*&nbsp;&nbsp;WA_FCAT-REF_TABNAME&nbsp;=&nbsp;'MARA'&nbsp;.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;wa_fcat-tabname&nbsp;=&nbsp;'GT_LIST'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-seltext_m&nbsp;=&nbsp;'Statü'&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;WA_FCAT-EDIT&nbsp;=&nbsp;'X'&nbsp;.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;append&nbsp;wa_fcat&nbsp;to&nbsp;it_fcat&nbsp;.<br />
&nbsp;&nbsp;clear&nbsp;wa_fcat&nbsp;.<br />
<br />
&nbsp;&nbsp;wa_fcat-col_pos&nbsp;=&nbsp;'5'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-fieldname&nbsp;=&nbsp;'STATUS_TEXT'&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;WA_FCAT-REF_FIELDNAME&nbsp;=&nbsp;'MBRSH'&nbsp;.<br />
*&nbsp;&nbsp;WA_FCAT-REF_TABNAME&nbsp;=&nbsp;'MARA'&nbsp;.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;wa_fcat-tabname&nbsp;=&nbsp;'GT_LIST'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-seltext_m&nbsp;=&nbsp;'Statü'&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;WA_FCAT-EDIT&nbsp;=&nbsp;'X'&nbsp;.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;append&nbsp;wa_fcat&nbsp;to&nbsp;it_fcat&nbsp;.<br />
&nbsp;&nbsp;clear&nbsp;wa_fcat&nbsp;.<br />
<br />
&nbsp;&nbsp;wa_fcat-col_pos&nbsp;=&nbsp;'6'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-fieldname&nbsp;=&nbsp;'PERM_TYPE'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-tabname&nbsp;=&nbsp;'GT_LIST'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-seltext_m&nbsp;=&nbsp;'Ýzin&nbsp;Türü'&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;WA_FCAT-EMPHASIZE&nbsp;=&nbsp;'C610'.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;append&nbsp;wa_fcat&nbsp;to&nbsp;it_fcat&nbsp;.<br />
&nbsp;&nbsp;clear&nbsp;wa_fcat&nbsp;.<br />
<br />
&nbsp;&nbsp;wa_fcat-col_pos&nbsp;=&nbsp;'7'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-fieldname&nbsp;=&nbsp;'PERM_TYPE_TEXT'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-tabname&nbsp;=&nbsp;'GT_LIST'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-seltext_m&nbsp;=&nbsp;'Ýzin&nbsp;Türü'&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;WA_FCAT-EMPHASIZE&nbsp;=&nbsp;'C610'.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;append&nbsp;wa_fcat&nbsp;to&nbsp;it_fcat&nbsp;.<br />
&nbsp;&nbsp;clear&nbsp;wa_fcat&nbsp;.<br />
<br />
&nbsp;&nbsp;wa_fcat-col_pos&nbsp;=&nbsp;'8'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-fieldname&nbsp;=&nbsp;'START_DATE'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-tabname&nbsp;=&nbsp;'GT_LIST'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-seltext_m&nbsp;=&nbsp;'Ýzin&nbsp;Baþ.&nbsp;T.'&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;WA_FCAT-KEY&nbsp;=&nbsp;'X'&nbsp;.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;append&nbsp;wa_fcat&nbsp;to&nbsp;it_fcat&nbsp;.<br />
&nbsp;&nbsp;clear&nbsp;wa_fcat&nbsp;.<br />
<br />
&nbsp;&nbsp;wa_fcat-col_pos&nbsp;=&nbsp;'9'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-fieldname&nbsp;=&nbsp;'END_DATE'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-tabname&nbsp;=&nbsp;'GT_LIST'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-seltext_m&nbsp;=&nbsp;'Ýzin&nbsp;Bit&nbsp;T.'&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;WA_FCAT-KEY&nbsp;=&nbsp;'X'&nbsp;.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;append&nbsp;wa_fcat&nbsp;to&nbsp;it_fcat&nbsp;.<br />
&nbsp;&nbsp;clear&nbsp;wa_fcat&nbsp;.<br />
<br />
&nbsp;&nbsp;wa_fcat-col_pos&nbsp;=&nbsp;'10'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-fieldname&nbsp;=&nbsp;'DAYS_OFF'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-tabname&nbsp;=&nbsp;'GT_LIST'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-seltext_m&nbsp;=&nbsp;'Ýzinli&nbsp;Gün&nbsp;S.'&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;WA_FCAT-KEY&nbsp;=&nbsp;'X'&nbsp;.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;append&nbsp;wa_fcat&nbsp;to&nbsp;it_fcat&nbsp;.<br />
&nbsp;&nbsp;clear&nbsp;wa_fcat&nbsp;.<br />
<br />
&nbsp;&nbsp;wa_fcat-col_pos&nbsp;=&nbsp;'11'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-fieldname&nbsp;=&nbsp;'STATEMENT'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-tabname&nbsp;=&nbsp;'GT_LIST'&nbsp;.<br />
&nbsp;&nbsp;wa_fcat-seltext_m&nbsp;=&nbsp;'Açýklama'&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;WA_FCAT-KEY&nbsp;=&nbsp;'X'&nbsp;.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;append&nbsp;wa_fcat&nbsp;to&nbsp;it_fcat&nbsp;.<br />
&nbsp;&nbsp;clear&nbsp;wa_fcat&nbsp;.<br />
<br />
endform.<br />
<br />
<br />
form sub_pf_status using rt_extab type slis_t_extab.<br />
&nbsp;&nbsp;set&nbsp;pf-status&nbsp;'ZSTANDARD'.<br />
endform.<br />
<br />
<br />
form user_command using<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r_ucomm&nbsp;like&nbsp;sy-ucomm<br />
&nbsp;&nbsp;ps_selfield&nbsp;type&nbsp;slis_selfield.<br />
&nbsp;&nbsp;data&nbsp;lv_mes&nbsp;type&nbsp;char200.<br />
&nbsp;&nbsp;if&nbsp;r_ucomm&nbsp;eq&nbsp;'&ONAY'.<br />
<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;lt_dd07t&nbsp;type&nbsp;standard&nbsp;table&nbsp;of&nbsp;dd07t.<br />
&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;ls_dd07t&nbsp;like&nbsp;line&nbsp;of&nbsp;lt_dd07t.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;*&nbsp;from&nbsp;dd07t&nbsp;into&nbsp;table&nbsp;lt_dd07t<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;ddlanguage&nbsp;eq&nbsp;'T'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;&nbsp;&nbsp;domname&nbsp;like&nbsp;'ZZPRM%'.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;read&nbsp;table&nbsp;gt_list&nbsp;into&nbsp;gs_list&nbsp;index&nbsp;ps_selfield-tabindex.<br />
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;gs_list-status&nbsp;=&nbsp;'05'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constants:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gc_subject1&nbsp;type&nbsp;so_obj_des&nbsp;value&nbsp;'ABAP&nbsp;Email&nbsp;with&nbsp;CL_BCS',<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gc_raw1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;char03&nbsp;value&nbsp;'RAW'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gv_mlrec1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;so_obj_nam,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gv_sent_to_all1&nbsp;&nbsp;&nbsp;type&nbsp;os_boolean,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gv_email1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;adr6-smtp_addr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gv_subject1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;so_obj_des,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gv_text1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;bcsy_text,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gr_send_request1&nbsp;&nbsp;type&nbsp;ref&nbsp;to&nbsp;cl_bcs,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gr_bcs_exception1&nbsp;type&nbsp;ref&nbsp;to&nbsp;cx_bcs,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gr_recipient1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;ref&nbsp;to&nbsp;if_recipient_bcs,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gr_sender1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;ref&nbsp;to&nbsp;if_sender_bcs&nbsp;value&nbsp;is&nbsp;initial,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gr_document1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;ref&nbsp;to&nbsp;cl_document_bcs,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gv_sender1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;adr6-smtp_addr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Create&nbsp;send&nbsp;request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gr_send_request1&nbsp;=&nbsp;cl_bcs=&gt;create_persistent(&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Email&nbsp;FROM...<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"gr_sender&nbsp;=&nbsp;cl_sapuser_bcs=&gt;create(&nbsp;sy-uname&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gv_sender1&nbsp;=&nbsp;'IK@mdpgroup.com'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gr_sender1&nbsp;=&nbsp;cl_cam_address_bcs=&gt;create_internet_address(&nbsp;gv_sender1&nbsp;).<br />
<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Add&nbsp;sender&nbsp;to&nbsp;send&nbsp;request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;method&nbsp;gr_send_request1-&gt;set_sender<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exporting<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_sender&nbsp;=&nbsp;gr_sender1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data:&nbsp;lv_pno1&nbsp;type&nbsp;zzprm_t001-pno.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;pno&nbsp;from&nbsp;zzprm_t001&nbsp;into&nbsp;lv_pno1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;pno&nbsp;eq&nbsp;gs_list-pno.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;ls_t002&nbsp;type&nbsp;zzprm_t001.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;*&nbsp;from&nbsp;zzprm_t001&nbsp;into&nbsp;ls_t002<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;pno&nbsp;eq&nbsp;lv_pno1.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;data&nbsp;lv_pypno2&nbsp;type&nbsp;zzprm_t001-pypno.<br />
*&nbsp;select&nbsp;single&nbsp;pypno&nbsp;from&nbsp;zzprm_t001&nbsp;into&nbsp;lv_pypno2<br />
*&nbsp;&nbsp;&nbsp;where&nbsp;pno&nbsp;eq&nbsp;lv_pypno.<br />
*<br />
*<br />
*&nbsp;&nbsp;&nbsp;data&nbsp;lss_t002&nbsp;type&nbsp;zzprm_t001.<br />
*&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;*&nbsp;from&nbsp;zzprm_t001&nbsp;into&nbsp;lss_t002<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;pno&nbsp;eq&nbsp;lv_pypno2.<br />
<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Email&nbsp;TO...<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gv_email1&nbsp;=&nbsp;ls_t002-pmail.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gr_recipient1&nbsp;=&nbsp;cl_cam_address_bcs=&gt;create_internet_address(&nbsp;gv_email1&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Add&nbsp;recipient&nbsp;to&nbsp;send&nbsp;request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;method&nbsp;gr_send_request1-&gt;add_recipient<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exporting<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_recipient&nbsp;=&nbsp;gr_recipient1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_express&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Email&nbsp;BODY<br />
   </div>
   <div class="codeComment">
*data&nbsp;lss_t001&nbsp;type&nbsp;zzprm_t001.<br />
*select&nbsp;single&nbsp;pnsurname&nbsp;from&nbsp;zzprm_t001&nbsp;into&nbsp;persad<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;pno&nbsp;eq&nbsp;persno.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;append&nbsp;lss_t001-pno&nbsp;to&nbsp;gv_text.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;lv_text&nbsp;type&nbsp;char255.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;concatenate&nbsp;gs_list-permformno&nbsp;'izin&nbsp;form&nbsp;numaralý&nbsp;talebiniz&nbsp;IK&nbsp;tarafýndan&nbsp;onaylanmýþtýr!'&nbsp;into&nbsp;lv_text<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;separated&nbsp;by&nbsp;space.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;append&nbsp;lv_text&nbsp;to&nbsp;gv_text1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"append&nbsp;'numaralý&nbsp;kiþi&nbsp;onay&nbsp;bekliyor!'&nbsp;to&nbsp;gv_text.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gr_document1&nbsp;=&nbsp;cl_document_bcs=&gt;create_document(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_type&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gc_raw1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_text&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gv_text1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_length&nbsp;&nbsp;=&nbsp;'12'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_subject&nbsp;=&nbsp;gc_subject1&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Add&nbsp;document&nbsp;to&nbsp;send&nbsp;request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;method&nbsp;gr_send_request1-&gt;set_document(&nbsp;gr_document1&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Send&nbsp;email<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;method&nbsp;gr_send_request1-&gt;send(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exporting<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_with_error_screen&nbsp;=&nbsp;'X'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;receiving<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gv_sent_to_all1&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;gv_sent_to_all1&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write&nbsp;'Email&nbsp;sent!'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Commit&nbsp;to&nbsp;send&nbsp;email<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;commit&nbsp;work.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Exception&nbsp;handling<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;catch&nbsp;cx_bcs&nbsp;into&nbsp;gr_bcs_exception1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'Error!',<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'Error&nbsp;type:',<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gr_bcs_exception1-&gt;error_type.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endtry.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;update&nbsp;zzprm_t003&nbsp;set&nbsp;status&nbsp;=&nbsp;'07'&nbsp;where&nbsp;permformno&nbsp;eq&nbsp;gs_list-permformno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;max(&nbsp;row_no&nbsp;)&nbsp;from&nbsp;zzprm_t004&nbsp;into&nbsp;sirano<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;permformno&nbsp;eq&nbsp;gs_list-permformno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_log4-row_no&nbsp;=&nbsp;sirano&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_log4-permformno&nbsp;=&nbsp;gs_list-permformno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_log4-status&nbsp;=&nbsp;'07'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_log4-pnsurname&nbsp;=&nbsp;persad.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_log4-date_&nbsp;=&nbsp;sy-datum.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_log4-hour_&nbsp;=&nbsp;sy-uzeit.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_log4-statement&nbsp;=&nbsp;aciklama.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;insert&nbsp;zzprm_t004&nbsp;from&nbsp;gs_log4.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;'Form&nbsp;onaylandý!'&nbsp;type&nbsp;'I'&nbsp;display&nbsp;like&nbsp;'S'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;elseif&nbsp;gs_list-status&nbsp;=&nbsp;'07'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;'Form&nbsp;onaylandý!'&nbsp;type&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elseif&nbsp;gs_list-status&nbsp;=&nbsp;'06'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;'Form&nbsp;reddedildi!'&nbsp;type&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
&nbsp;&nbsp;endif.<br />
&nbsp;&nbsp;case&nbsp;r_ucomm.<br />
&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'&RED'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read&nbsp;table&nbsp;gt_list&nbsp;into&nbsp;gs_list&nbsp;index&nbsp;ps_selfield-tabindex.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;gs_list-status&nbsp;=&nbsp;'05'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data:&nbsp;lt_fields&nbsp;like&nbsp;sval&nbsp;occurs&nbsp;0&nbsp;with&nbsp;header&nbsp;line,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_ret&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;string.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;refresh&nbsp;lt_fields.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_fields-tabname&nbsp;=&nbsp;'ZZPRM_T004'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_fields-fieldname&nbsp;=&nbsp;'STATEMENT'.<br />
   </div>
   <div class="codeComment">
*lt_fields-value&nbsp;=&nbsp;''.<br />
*lt_fields-field_attr&nbsp;=&nbsp;''.<br />
*lt_fields-field_obl&nbsp;=&nbsp;''.<br />
*lt_fields-comp_code&nbsp;=&nbsp;''.<br />
*lt_fields-fieldtext&nbsp;=&nbsp;''.<br />
*lt_fields-comp_tab&nbsp;=&nbsp;''.<br />
*lt_fields-comp_field&nbsp;=&nbsp;''.<br />
*lt_fields-novaluehlp&nbsp;=&nbsp;''.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;append&nbsp;lt_fields.<br />
   </div>
   <div class="codeComment">
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_fields-tabname&nbsp;=&nbsp;'MARA'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_fields-fieldname&nbsp;=&nbsp;'MTART'.<br />
****lt_fields-value&nbsp;=&nbsp;''.<br />
****lt_fields-field_attr&nbsp;=&nbsp;''.<br />
****lt_fields-field_obl&nbsp;=&nbsp;''.<br />
****lt_fields-comp_code&nbsp;=&nbsp;''.<br />
****lt_fields-fieldtext&nbsp;=&nbsp;''.<br />
****lt_fields-comp_tab&nbsp;=&nbsp;''.<br />
****lt_fields-comp_field&nbsp;=&nbsp;''.<br />
****lt_fields-novaluehlp&nbsp;=&nbsp;''.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;append&nbsp;lt_fields.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clear&nbsp;lv_ret.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;function&nbsp;'POPUP_GET_VALUES'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exporting<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NO_VALUE_CHECK&nbsp;&nbsp;=&nbsp;'&nbsp;'<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;popup_title&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Bilgileri&nbsp;giriniz'<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;START_COLUMN&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'5'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;START_ROW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'5'<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;importing<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returncode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_ret<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tables<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fields&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lt_fields<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exceptions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_in_fields&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;others&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;lv_rnedeni&nbsp;type&nbsp;zzprm_t004-statement.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;lv_ret&nbsp;is&nbsp;initial.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read&nbsp;table&nbsp;lt_fields&nbsp;with&nbsp;key&nbsp;tabname&nbsp;=&nbsp;'ZZPRM_T004'&nbsp;fieldname&nbsp;=&nbsp;'STATEMENT'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_rnedeni&nbsp;=&nbsp;lt_fields-value.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;max(&nbsp;row_no&nbsp;)&nbsp;from&nbsp;zzprm_t004&nbsp;into&nbsp;sirano<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;permformno&nbsp;eq&nbsp;gs_list-permformno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_log4-row_no&nbsp;=&nbsp;sirano&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_log4-permformno&nbsp;=&nbsp;gs_list-permformno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_log4-status&nbsp;=&nbsp;'06'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_log4-pnsurname&nbsp;=&nbsp;persad.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_log4-date_&nbsp;=&nbsp;sy-datum.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_log4-hour_&nbsp;=&nbsp;sy-uzeit.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_log4-statement&nbsp;=&nbsp;lv_rnedeni.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;insert&nbsp;zzprm_t004&nbsp;from&nbsp;gs_log4.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constants:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gc_subject11&nbsp;type&nbsp;so_obj_des&nbsp;value&nbsp;'ABAP&nbsp;Email&nbsp;with&nbsp;CL_BCS',<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gc_raw11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;char03&nbsp;value&nbsp;'RAW'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gv_mlrec11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;so_obj_nam,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gv_sent_to_all11&nbsp;&nbsp;&nbsp;type&nbsp;os_boolean,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gv_email11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;adr6-smtp_addr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gv_subject11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;so_obj_des,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gv_text11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;bcsy_text,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gr_send_request11&nbsp;&nbsp;type&nbsp;ref&nbsp;to&nbsp;cl_bcs,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gr_bcs_exception11&nbsp;type&nbsp;ref&nbsp;to&nbsp;cx_bcs,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gr_recipient11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;ref&nbsp;to&nbsp;if_recipient_bcs,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gr_sender11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;ref&nbsp;to&nbsp;if_sender_bcs&nbsp;value&nbsp;is&nbsp;initial,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gr_document11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;ref&nbsp;to&nbsp;cl_document_bcs,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gv_sender11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;adr6-smtp_addr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Create&nbsp;send&nbsp;request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gr_send_request11&nbsp;=&nbsp;cl_bcs=&gt;create_persistent(&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Email&nbsp;FROM...<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"gr_sender&nbsp;=&nbsp;cl_sapuser_bcs=&gt;create(&nbsp;sy-uname&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gv_sender11&nbsp;=&nbsp;'IK@mdpgroup.com'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gr_sender11&nbsp;=&nbsp;cl_cam_address_bcs=&gt;create_internet_address(&nbsp;gv_sender11&nbsp;).<br />
<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Add&nbsp;sender&nbsp;to&nbsp;send&nbsp;request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;method&nbsp;gr_send_request11-&gt;set_sender<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exporting<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_sender&nbsp;=&nbsp;gr_sender11.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data:&nbsp;lv_pno11&nbsp;type&nbsp;zzprm_t001-pno.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;pno&nbsp;from&nbsp;zzprm_t001&nbsp;into&nbsp;lv_pno11<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;pno&nbsp;eq&nbsp;gs_list-pno.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;ls_t0021&nbsp;type&nbsp;zzprm_t001.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;*&nbsp;from&nbsp;zzprm_t001&nbsp;into&nbsp;ls_t0021<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;pno&nbsp;eq&nbsp;lv_pno11.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;data&nbsp;lv_pypno2&nbsp;type&nbsp;zzprm_t001-pypno.<br />
*&nbsp;select&nbsp;single&nbsp;pypno&nbsp;from&nbsp;zzprm_t001&nbsp;into&nbsp;lv_pypno2<br />
*&nbsp;&nbsp;&nbsp;where&nbsp;pno&nbsp;eq&nbsp;lv_pypno.<br />
*<br />
*<br />
*&nbsp;&nbsp;&nbsp;data&nbsp;lss_t002&nbsp;type&nbsp;zzprm_t001.<br />
*&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;*&nbsp;from&nbsp;zzprm_t001&nbsp;into&nbsp;lss_t002<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;pno&nbsp;eq&nbsp;lv_pypno2.<br />
<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Email&nbsp;TO...<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gv_email11&nbsp;=&nbsp;ls_t0021-pmail.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gr_recipient11&nbsp;=&nbsp;cl_cam_address_bcs=&gt;create_internet_address(&nbsp;gv_email11&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Add&nbsp;recipient&nbsp;to&nbsp;send&nbsp;request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;method&nbsp;gr_send_request11-&gt;add_recipient<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exporting<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_recipient&nbsp;=&nbsp;gr_recipient11<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_express&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Email&nbsp;BODY<br />
   </div>
   <div class="codeComment">
*data&nbsp;lss_t001&nbsp;type&nbsp;zzprm_t001.<br />
*select&nbsp;single&nbsp;pnsurname&nbsp;from&nbsp;zzprm_t001&nbsp;into&nbsp;persad<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;pno&nbsp;eq&nbsp;persno.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;append&nbsp;lss_t001-pno&nbsp;to&nbsp;gv_text.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;lv_text1&nbsp;type&nbsp;char255.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;concatenate&nbsp;gs_list-permformno&nbsp;'izin&nbsp;form&nbsp;numaralý&nbsp;talebiniz&nbsp;IK&nbsp;tarafýndan'&nbsp;gs_log4-statement&nbsp;'nedeninden&nbsp;dolayý&nbsp;reddedilmiþtir!'&nbsp;into&nbsp;lv_text1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;separated&nbsp;by&nbsp;space.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;append&nbsp;lv_text1&nbsp;to&nbsp;gv_text11.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"append&nbsp;'numaralý&nbsp;kiþi&nbsp;onay&nbsp;bekliyor!'&nbsp;to&nbsp;gv_text.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gr_document11&nbsp;=&nbsp;cl_document_bcs=&gt;create_document(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_type&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gc_raw11<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_text&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gv_text11<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_length&nbsp;&nbsp;=&nbsp;'12'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_subject&nbsp;=&nbsp;gc_subject11&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Add&nbsp;document&nbsp;to&nbsp;send&nbsp;request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;method&nbsp;gr_send_request11-&gt;set_document(&nbsp;gr_document11&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Send&nbsp;email<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;method&nbsp;gr_send_request11-&gt;send(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exporting<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_with_error_screen&nbsp;=&nbsp;'X'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;receiving<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gv_sent_to_all11&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;gv_sent_to_all11&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write&nbsp;'Email&nbsp;sent!'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Commit&nbsp;to&nbsp;send&nbsp;email<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;commit&nbsp;work.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Exception&nbsp;handling<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;catch&nbsp;cx_bcs&nbsp;into&nbsp;gr_bcs_exception11.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'Error!',<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'Error&nbsp;type:',<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gr_bcs_exception11-&gt;error_type.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endtry.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;update&nbsp;zzprm_t003&nbsp;set&nbsp;status&nbsp;=&nbsp;'06'&nbsp;where&nbsp;permformno&nbsp;eq&nbsp;gs_list-permformno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elseif&nbsp;gs_list-status&nbsp;=&nbsp;'06'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;'Form&nbsp;reddedildi!'&nbsp;type&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elseif&nbsp;gs_list-status&nbsp;=&nbsp;'07'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;'Form&nbsp;onaylandý!'&nbsp;type&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'&YAZDIR'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read&nbsp;table&nbsp;gt_list&nbsp;into&nbsp;gs_list&nbsp;index&nbsp;ps_selfield-tabindex.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;gs_list-status&nbsp;=&nbsp;'07'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data:&nbsp;fm_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;rs38l_fnam,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;CHAR&nbsp;30&nbsp;0&nbsp;Name&nbsp;of&nbsp;Function&nbsp;Module<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fp_docparams&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;sfpdocparams,&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Structure&nbsp;&nbsp;SFPDOCPARAMS&nbsp;Short&nbsp;Description&nbsp;&nbsp;Form&nbsp;Parameters&nbsp;for&nbsp;Form&nbsp;Processing<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fp_outputparams&nbsp;type&nbsp;sfpoutputparams,&nbsp;"&nbsp;Structure&nbsp;&nbsp;SFPOUTPUTPARAMS&nbsp;Short&nbsp;Description&nbsp;&nbsp;Form&nbsp;Processing&nbsp;Output&nbsp;Parameter<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_permission&nbsp;&nbsp;&nbsp;type&nbsp;zzprm_s001.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Table&nbsp;Type&nbsp;ZMARI_TBL&nbsp;MARI&nbsp;Table&nbsp;Tyoe<br />
   </div>
   <div class="codeComment">
*&nbsp;Sets&nbsp;the&nbsp;output&nbsp;parameters&nbsp;and&nbsp;opens&nbsp;the&nbsp;spool&nbsp;job<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;function&nbsp;'FP_JOB_OPEN'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&&nbsp;Form&nbsp;Processing:&nbsp;Call&nbsp;Form<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;changing<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ie_outputparams&nbsp;=&nbsp;fp_outputparams<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exceptions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cancel&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;usage_error&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system_error&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;internal_error&nbsp;&nbsp;=&nbsp;4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;others&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;error&nbsp;handling&gt;<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
   </div>
   <div class="codeComment">
*&----&nbsp;Get&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;generated&nbsp;function&nbsp;module<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;function&nbsp;'FP_FUNCTION_MODULE_NAME'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&&nbsp;Form&nbsp;Processing&nbsp;Generation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exporting<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZZPRM_0022'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;importing<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e_funcname&nbsp;=&nbsp;fm_name.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&lt;error&nbsp;handling&gt;<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
   </div>
   <div class="codeComment">
*--&nbsp;Fetch&nbsp;the&nbsp;Data&nbsp;and&nbsp;store&nbsp;it&nbsp;in&nbsp;the&nbsp;Internal&nbsp;Table<br />
<br />
***&nbsp;Language&nbsp;and&nbsp;country&nbsp;setting&nbsp;(here&nbsp;US&nbsp;as&nbsp;an&nbsp;example)<br />
**fp_docparams-langu&nbsp;&nbsp;&nbsp;=&nbsp;'E'.<br />
**fp_docparams-country&nbsp;=&nbsp;'US'.<br />
*&---&nbsp;Call&nbsp;the&nbsp;generated&nbsp;function&nbsp;module<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;move-corresponding&nbsp;gs_list&nbsp;to&nbsp;ls_permission.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;pdepartment&nbsp;from&nbsp;zzprm_t001&nbsp;into&nbsp;ls_permission-pdepartment<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;pno&nbsp;eq&nbsp;ls_permission-pno.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;pmail&nbsp;from&nbsp;zzprm_t001&nbsp;into&nbsp;ls_permission-pmail<br />
&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;pno&nbsp;eq&nbsp;ls_permission-pno.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read&nbsp;table&nbsp;lt_dd07t&nbsp;into&nbsp;ls_dd07t&nbsp;with&nbsp;key&nbsp;domname&nbsp;=&nbsp;'ZZPRM_PERMTYPE_DO'&nbsp;domvalue_l&nbsp;=&nbsp;gs_list-perm_type.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;sy-subrc&nbsp;eq&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_list-perm_type_text&nbsp;=&nbsp;ls_dd07t-ddtext.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data:&nbsp;lv_pypno&nbsp;type&nbsp;zzprm_t001-pypno.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;pypno&nbsp;from&nbsp;zzprm_t001&nbsp;into&nbsp;lv_pypno<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;pno&nbsp;eq&nbsp;gs_list-pno.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;ls_t0011&nbsp;type&nbsp;zzprm_t001.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;*&nbsp;from&nbsp;zzprm_t001&nbsp;into&nbsp;ls_t0011<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;pno&nbsp;eq&nbsp;lv_pypno.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;pnsurname&nbsp;from&nbsp;zzprm_t001&nbsp;into&nbsp;ls_permission-pnsurname2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;pno&nbsp;eq&nbsp;ls_t0011-pno.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;pdepartment&nbsp;from&nbsp;zzprm_t001&nbsp;into&nbsp;ls_permission-pdepartment2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;pno&nbsp;eq&nbsp;ls_t0011-pno.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data:&nbsp;lv_permformno&nbsp;type&nbsp;zzprm_t004-permformno.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;permformno&nbsp;from&nbsp;zzprm_t004&nbsp;into&nbsp;lv_permformno<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;permformno&nbsp;eq&nbsp;gs_list-permformno.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;ls_t00111&nbsp;type&nbsp;zzprm_t004.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;*&nbsp;from&nbsp;zzprm_t004&nbsp;into&nbsp;ls_t00111<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;permformno&nbsp;eq&nbsp;lv_permformno.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;date_&nbsp;from&nbsp;zzprm_t004&nbsp;into&nbsp;ls_permission-date_<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;permformno&nbsp;eq&nbsp;ls_t00111-permformno&nbsp;and&nbsp;status&nbsp;=&nbsp;'07'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;date_&nbsp;from&nbsp;zzprm_t004&nbsp;into&nbsp;ls_permission-date2_<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;permformno&nbsp;eq&nbsp;ls_t00111-permformno&nbsp;and&nbsp;status&nbsp;=&nbsp;'03'.<br />
   </div>
   <div class="codeComment">
*select&nbsp;single&nbsp;pmail&nbsp;from&nbsp;zzprm_t001&nbsp;into&nbsp;ls_permission-<br />
<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data:&nbsp;lv_pypno&nbsp;type&nbsp;zzprm_t001-pypno.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;pypno&nbsp;from&nbsp;zzprm_t001&nbsp;into&nbsp;lv_pypno<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;pno&nbsp;eq&nbsp;gs_list-pno.<br />
*<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;ls_t0011&nbsp;type&nbsp;zzprm_t001.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;*&nbsp;from&nbsp;zzprm_t001&nbsp;into&nbsp;ls_t0011<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;pno&nbsp;eq&nbsp;lv_pypno.<br />
<br />
*&nbsp;select&nbsp;single&nbsp;pnsurname&nbsp;from&nbsp;zzprm_t001&nbsp;into&nbsp;gs_list-pnsurname2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;pno&nbsp;eq&nbsp;ls_permission-pno.<br />
<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;function&nbsp;fm_name<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exporting<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/1bcdwb/docparams&nbsp;=&nbsp;fp_docparams<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_permission&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_permission<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/1BCDWB/FORMOUTPUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exceptions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;usage_error&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system_error&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;internal_error&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&lt;error&nbsp;handling&gt;<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
   </div>
   <div class="codeComment">
*&----&nbsp;Close&nbsp;the&nbsp;spool&nbsp;job<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;function&nbsp;'FP_JOB_CLOSE'<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E_RESULT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exceptions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;usage_error&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system_error&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;internal_error&nbsp;=&nbsp;3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;others&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;error&nbsp;handling&gt;<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
&nbsp;&nbsp;&nbsp;&nbsp;elseif&nbsp;gs_list-status&nbsp;=&nbsp;'05'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;'Form&nbsp;IK&nbsp;onayýnda!'&nbsp;type&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elseif&nbsp;gs_list-status&nbsp;=&nbsp;'06'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;'Form&nbsp;reddedildi!'&nbsp;type&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'&GECMIS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_layout2-zebra&nbsp;=&nbsp;abap_true.<br />
<br />
&nbsp;&nbsp;gs_layout2-colwidth_optimize&nbsp;=&nbsp;abap_true.<br />
&nbsp;&nbsp;gs_layout2-colwidth_optimize&nbsp;=&nbsp;abap_true.<br />
&nbsp;&nbsp;gs_layout2-box_fieldname&nbsp;=&nbsp;'SELKZ'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;lt_dd07t1&nbsp;type&nbsp;standard&nbsp;table&nbsp;of&nbsp;dd07t.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;ls_dd07t1&nbsp;like&nbsp;line&nbsp;of&nbsp;lt_dd07t1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;*&nbsp;from&nbsp;dd07t&nbsp;into&nbsp;table&nbsp;lt_dd07t1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;ddlanguage&nbsp;eq&nbsp;'T'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;&nbsp;&nbsp;domname&nbsp;like&nbsp;'ZZPRM%'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read&nbsp;table&nbsp;gt_list&nbsp;into&nbsp;gs_list&nbsp;index&nbsp;ps_selfield-tabindex.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permformno<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_no<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;status<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pnsurname<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;date_<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hour_<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;statement<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zzprm_t004&nbsp;into&nbsp;corresponding&nbsp;fields&nbsp;of&nbsp;table&nbsp;gt_t004<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;permformno&nbsp;eq&nbsp;gs_list-permformno.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loop&nbsp;at&nbsp;gt_t004&nbsp;into&nbsp;gs_t004.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read&nbsp;table&nbsp;lt_dd07t1&nbsp;into&nbsp;ls_dd07t1&nbsp;with&nbsp;key&nbsp;domname&nbsp;=&nbsp;'ZZPRM_STATU_DO'&nbsp;domvalue_l&nbsp;=&nbsp;gs_t004-status.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;sy-subrc&nbsp;eq&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_t004-status_text1&nbsp;=&nbsp;ls_dd07t1-ddtext.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;pnsurname&nbsp;from&nbsp;zzprm_t001&nbsp;into&nbsp;gs_t004-pnsurname<br />
&nbsp;&nbsp;where&nbsp;pno&nbsp;eq&nbsp;gs_list-pno.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modify&nbsp;gt_t004&nbsp;from&nbsp;gs_t004.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endloop.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cl_salv_table=&gt;factory(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;importing<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r_salv_table&nbsp;&nbsp;&nbsp;=&nbsp;go_salv<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;changing<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t_table&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gt_t004<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;go_salv-&gt;set_screen_popup(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exporting<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;start_column&nbsp;=&nbsp;10<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end_column&nbsp;&nbsp;&nbsp;=&nbsp;75<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;start_line&nbsp;&nbsp;&nbsp;=&nbsp;5<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end_line&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;25<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;go_salv-&gt;display(&nbsp;).<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;endloop.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;endcase.<br />
endform.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;set_layout<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
<br />
<br />
*Messages<br />
*----------------------------------------------------------<br />
*<br />
*&nbsp;Message&nbsp;class:&nbsp;Hard&nbsp;coded<br />
*&nbsp;&nbsp;&nbsp;Form&nbsp;onaylandý!<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
